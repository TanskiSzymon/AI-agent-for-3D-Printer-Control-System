[gcode_macro _LINE_PURGE]
description: Proste czyszczenie dyszy wg Twojej sekwencji
variable_x1: 300.0
variable_y1: 100.0
variable_z1: 10.0
variable_f1: 1000

variable_x2: 306.0
variable_y2: 80.0
variable_z2: 2.0
variable_f2: 500

variable_x3: 306.0
variable_y3: 80.0
variable_z3: 0.0
variable_f3: 50

variable_x4: 306.0
variable_y4: 80.0
variable_z4: 0.3
variable_f4: 50

variable_x5: 299.0
variable_y5: 80.0
variable_z5: 0.3
variable_f5: 100

variable_x6: 295.0
variable_y6: 80.0
variable_z6: 0.3
variable_f6: 100

variable_x7: 290.0
variable_y7: 80.0
variable_z7: 10.0
variable_f7: 200

variable_extrude_mm: 50.0
variable_extrude_f: 1200

variable_t_hot: 225    
variable_t_cool: 180    


variable_fan_hi: 211.65
variable_fan_lo: 20

gcode:
  {% if "xyz" not in printer.toolhead.homed_axes %}
    G28
  {% endif %}

  G90
  M83

  G0 X{ x1 } Y{ y1 } Z{ z1 } F{ f1 }
  G0 X{ x2 } Y{ y2 } Z{ z2 } F{ f2 }
  G0 X{ x3 } Y{ y3 } Z{ z3 } F{ f3 }

  SET_HEATER_TEMPERATURE HEATER=extruder TARGET={ t_hot }
  TEMPERATURE_WAIT SENSOR=extruder MINIMUM={ t_hot }

  G1 E{ extrude_mm } F{ extrude_f }

  G0 X{ x4 } Y{ y4 } Z{ z4 } F{ f4 }
  G0 X{ x5 } Y{ y5 } Z{ z5 } F{ f5 }

  SET_HEATER_TEMPERATURE HEATER=extruder TARGET={ t_cool }
  SET_PIN PIN=fan0 VALUE={ fan_hi }
  TEMPERATURE_WAIT SENSOR=extruder MAXIMUM={ t_cool }
  SET_PIN PIN=fan0 VALUE={ fan_lo }

  G0 X{ x6 } Y{ y6 } Z{ z6 } F{ f6 }
  G0 X{ x7 } Y{ y7 } Z{ z7 } F{ f7 }
